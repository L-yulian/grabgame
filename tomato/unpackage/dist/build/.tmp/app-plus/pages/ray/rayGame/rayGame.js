(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/ray/rayGame/rayGame"],{"029b":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(n("0f6e")),i=s(n("f863")),a=n("2f62");function s(e){return e&&e.__esModule?e:{default:e}}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){r(e,t,n[t])})}return e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=0,l={data:function(){return{style:{pageHeight:0,contentViewHeight:0,footViewHeight:90,mitemHeight:0,bannerShow:!1},url:"http://img.tukuppt.com/preview_music/00/00/75/xf-5b87af31dabd34149.mp3",bannerShow:!1,scrollTop:0,grabhb:!1,messages:[],previewList:[],roomid:"",callindex:"",currentHb_id:"",grabacount:"",istouchMove:!1,bgAudioMannager:null}},onLoad:function(t){console.log(t),e.setNavigationBarTitle({title:t.title});var n=t.websocketIsOpen,o=e.getSystemInfoSync();this.style.pageHeight=o.windowHeight,this.style.contentViewHeight=o.windowHeight-e.getSystemInfoSync().screenWidth/750*100,this.roomid=t.roomid,this.callindex=t.callindex,this.loadRoomInfo(this.roomid,this.callindex,n);var i=this;e.onSocketClose(function(){console.log("socket 关闭了"),setTimeout(function(){e.connectSocket({url:i.$webSocketUrl+"plhb_chat"}),e.onSocketOpen(function(){console.log("WebSocket连接已打开！"),i.websocketIsOpen=!0})},2e3)})},onShow:function(){console.log("scrollTop",u),e.pageScrollTo({scrollTop:u})},computed:c({},(0,a.mapGetters)({userid:"getUserId",user:"getUserInfo"})),onBackPress:function(t){var n={user_id:this.userid,room_id:this.roomid,act:"quit",msg:""},o=JSON.stringify(n);console.log("msg"+o),e.sendSocketMessage({data:o})},onReachBottom:function(){this.istouchMove=!1},methods:{moveHandle:function(){},closeBanner:function(){var e=this;e.bannerShow=!e.bannerShow},closegrabhb:function(){this.grabhb=!this.grabhb},loadRoomInfo:function(t,n,o){var i=this,a={roomid:t},s={user_id:i.userid,room_id:t,act:"login",msg:""},c=JSON.stringify(s);i=this;this.$utils.pluginRequest("pl_room_join",n,a,"POST","",function(t){0==t.code&&o&&(e.sendSocketMessage({data:c}),e.onSocketMessage(function(t){console.log(t.data),JSON.parse(t.data).data.forEach(function(n,o){n.act=JSON.parse(t.data).act,n.user_id==i.$store.getters.getUserId?n.role="home":n.role="customer",n.role=n.user_id==i.$store.getters.getUserId?"home":"customer",i.addMessage(n,i),i.bgAudioMannager=e.getBackgroundAudioManager(),i.bgAudioMannager.src=i.url,i.istouchMove||i.scrollToBottom()})}))},function(e){},function(e){})},addMessage:function(e,t){t.messages.push(e)},saveScrollOff:function(){e.createSelectorQuery().selectViewport().scrollOffset(function(e){u=e.scrollTop}).exec()},scrollToBottom:function(){var t=this,n=e.createSelectorQuery();n.selectAll(".m-item").boundingClientRect(),n.exec(function(e){t.style.mitemHeight=0,e[0].forEach(function(e){t.style.mitemHeight=t.style.mitemHeight+e.height+20})}),n.selectAll(".t-common-font").boundingClientRect(),n.exec(function(n){n[0].forEach(function(e){t.style.mitemHeight=t.style.mitemHeight+e.height+20}),t.style.mitemHeight>t.style.contentViewHeight&&e.pageScrollTo({scrollTop:t.style.mitemHeight,duration:500})})},SendRedEnvelope:function(t){this.saveScrollOff(),e.navigateTo({url:"../sendRnvelope/sendRnvelope?roomid="+this.roomid+"&callindex="+this.callindex,success:function(e){},fail:function(){},complete:function(){}})},balance:function(t){var n=this;this.$utils.refreshMyInfo(function(){e.showModal({confirmColor:"#FC4B2D",confirmText:"知道了",showCancel:!1,content:"余额"+n.user.amount+"元"})})},click:function(t){var n=this;this.istouchMove=!0;var o=this,i={roomid:this.roomid,hbid:t.hb_id};o.currentHb_id=t.hb_id,this.$utils.defalsePluginRequest("pl_hb_open",this.callindex,i,function(t){0==t.code?(n.grabacount=t.data,o.grabhb=!0):3001==t.code?e.showModal({title:"提示",content:t.msg,showCancel:!0,cancelText:"知道了",confirmText:"去充值",confirmColor:"#D81E06",success:function(t){t.confirm?e.navigateTo({url:"../../my/recharge/recharge",success:function(e){},fail:function(){},complete:function(){}}):t.cancel},fail:function(){},complete:function(){}}):o.bannerShow=!0},function(e){},function(e){})},clickPic:function(){this.saveScrollOff(),e.navigateTo({url:"../rayRecords/rayRecords?roomid="+this.roomid+"&callindex="+this.callindex+"&hbid="+this.currentHb_id,success:function(e){},fail:function(){},complete:function(){}})},touchmoveView:function(){this.istouchMove=!0}},components:{messageShow:o.default,resultMessage:i.default}};t.default=l}).call(this,n("649d")["default"])},"0304":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={name:"result-message",data:function(){return{}},props:["message","id"],computed:{username:function(){return this.$utils.defaultPlusXing(this.message.user_name)}}};t.default=o},"043a":function(e,t,n){"use strict";var o=n("b1ec"),i=n.n(o);i.a},"0b1d":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",[n("view",{staticClass:"uni-column"},[n("view",{staticClass:"content",attrs:{id:"content",eventid:"9f206a22-1"},on:{touchmove:e.touchmoveView}},e._l(e.messages,function(t,o){return n("block",{key:o},["hb"==t.act?n("message-show",{attrs:{message:t,id:o,eventid:"9f206a22-0-"+o,mpcomid:"9f206a22-0-"+o},on:{"open-redEnvelopes":e.click}}):e._e(),"hbresult"==t.act?n("result-message",{attrs:{message:t,id:o,mpcomid:"9f206a22-1-"+o}}):e._e()],1)})),n("view",{staticClass:"foot"},[n("view",{staticClass:"foot-left",attrs:{eventid:"9f206a22-2"},on:{tap:e.SendRedEnvelope}},[e._v("一键发包")]),n("view",{staticClass:"foot-right",attrs:{eventid:"9f206a22-3"},on:{tap:e.balance}},[e._v("余额")])])]),e.bannerShow?n("view",[e.bannerShow?n("view",{staticClass:"uni-banner",attrs:{eventid:"9f206a22-4"},on:{tap:e.clickPic}},[e._m(0),e._m(1)]):e._e(),e.bannerShow?n("view",{staticClass:"uni-mask",attrs:{eventid:"9f206a22-5"},on:{tap:e.closeBanner,touchmove:function(t){t.stopPropagation(),t.preventDefault(),e.moveHandle(t)}}}):e._e()]):e._e(),e.grabhb?n("view",[e.grabhb?n("view",{staticClass:"uni-banner"},[e._m(2),n("view",{staticStyle:{position:"relative",color:"#FFFFFF","text-align":"center","margin-top":"-200rpx"}},[n("view",[e._v("红包金额")]),n("view",[e._v(e._s(e.grabacount)+"元")])])]):e._e(),e.grabhb?n("view",{staticClass:"uni-mask",attrs:{eventid:"9f206a22-6"},on:{tap:e.closegrabhb,touchmove:function(t){t.stopPropagation(),t.preventDefault(),e.moveHandle(t)}}}):e._e()]):e._e()])},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",[n("image",{staticStyle:{width:"100%"},attrs:{src:"../../../static/img/ic_openredp_redp_img.png",mode:"widthFix"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticStyle:{position:"relative",color:"#FFFFFF","text-align":"center",margin:"-200rpx"}},[n("view",[e._v("已抢过该红包")]),n("view",[e._v("查看全部")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",[n("image",{staticStyle:{width:"100%"},attrs:{src:"../../../static/img/ic_openredp_redp_img.png",mode:"widthFix"}})])}];n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i})},"0f6e":function(e,t,n){"use strict";n.r(t);var o=n("21aa"),i=n("2982");for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);n("043a"),n("b4ee");var s=n("2877"),c=Object(s["a"])(i["default"],o["a"],o["b"],!1,null,null,null);t["default"]=c.exports},"15fa":function(e,t,n){"use strict";n.r(t);var o=n("029b"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,function(){return o[e]})}(a);t["default"]=i.a},"21aa":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:"m-item m-all",attrs:{id:"message"+e.id}},[n("view",{staticClass:"m-left"},["home"==e.message.role?n("image",{staticClass:"head_icon",attrs:{src:e.message.avatar}}):e._e()]),n("view",{staticClass:"m-content m-content-one"},[n("view",{staticClass:"m-content-name",class:{"m-content-name-right":"customer"==e.message.role}},[e._v(e._s(e.username))]),n("view",{staticClass:"m-content-head",class:{"m-content-head-right":"customer"==e.message.role},attrs:{eventid:"3b2c9058-0"},on:{tap:e.open}},[n("view",{class:"m-content-head-"+e.message.role},[n("view",{staticClass:"content-top"},[e._m(0),n("view",{staticClass:"content-top-right"},[n("view",[e._v("恭喜发财 大吉大利")]),n("view",[e._v(e._s(e.message.redamount)+"-"+e._s(e.message.buryingpoint))])])]),n("view",{staticClass:"content-bottom"},[e._v("金辉红包")])])])]),n("view",{staticClass:"m-right"},["customer"==e.message.role?n("image",{staticClass:"head_icon",attrs:{src:e.message.avatar}}):e._e()])])},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:"content-top-left"},[n("image",{attrs:{src:"../../../static/img/ic_chats_redpsmall_icon.png"}})])}];n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i})},2982:function(e,t,n){"use strict";n.r(t);var o=n("eac3"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,function(){return o[e]})}(a);t["default"]=i.a},"4d7b":function(e,t,n){"use strict";var o=n("e700"),i=n.n(o);i.a},"4e4b":function(e,t,n){"use strict";n("316d");var o=a(n("b0ce")),i=a(n("68fa"));function a(e){return e&&e.__esModule?e:{default:e}}Page((0,o.default)(i.default))},"68fa":function(e,t,n){"use strict";n.r(t);var o=n("0b1d"),i=n("15fa");for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);n("4d7b"),n("d740");var s=n("2877"),c=Object(s["a"])(i["default"],o["a"],o["b"],!1,null,null,null);t["default"]=c.exports},7927:function(e,t,n){},"83f4":function(e,t,n){},"8d92":function(e,t,n){},"8fda":function(e,t,n){"use strict";n.r(t);var o=n("0304"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,function(){return o[e]})}(a);t["default"]=i.a},b1ec:function(e,t,n){},b4ee:function(e,t,n){"use strict";var o=n("8d92"),i=n.n(o);i.a},d740:function(e,t,n){"use strict";var o=n("7927"),i=n.n(o);i.a},e700:function(e,t,n){},eac3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={name:"message-show",data:function(){return{}},props:["message","id"],computed:{username:function(){return this.$utils.defaultPlusXing(this.message.user_name)}},methods:{open:function(){var e=this;this.$emit("open-redEnvelopes",e.message)}}};t.default=o},f4a9:function(e,t,n){"use strict";var o=n("83f4"),i=n.n(o);i.a},f863:function(e,t,n){"use strict";n.r(t);var o=n("fc89"),i=n("8fda");for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);n("f4a9");var s=n("2877"),c=Object(s["a"])(i["default"],o["a"],o["b"],!1,null,null,null);t["default"]=c.exports},fc89:function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:"t-common-font m-all"},[n("view",{staticClass:"rm-content m-content-one"},[n("image",{attrs:{src:"../../../static/img/ic_chats_redpsmall_icon.png",mode:"aspectFill"}}),n("text",[e._v("恭喜"+e._s(e.username)+"中奖，奖励"+e._s(e.message.value)+"元")])])])},i=[];n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i})}},[["4e4b","common/runtime","common/vendor"]]]);